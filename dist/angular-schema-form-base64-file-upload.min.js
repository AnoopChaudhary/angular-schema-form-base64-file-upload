angular.module("templates",[]).run(["$templateCache",function(e){e.put("src/templates/angular-schema-form-base64-file-upload.html",'<div class="angular-schema-form--base64-file" ng-class="{\'has-error\': form.disableErrorState !== true && hasError(), \'has-success\': form.disableSuccessState !== true && hasSuccess(), \'has-feedback\': form.feedback !== false}">\n  <label class="control-label" ng-hide="form.notitle">{{form.title}}</label>\n  <div base64-file-upload="form" sf-field-model schema-validate="form">\n    <label>\n      <input type="file" class="base64-file--input" style="display:none;" ng-disabled="hasFile"/>\n      <div class="base64-file--drop-area" ng-class="{\'file-hovering\': dropAreaHover, \'has-file\': hasFile}">\n\n        <div class="base64-file--file" ng-show="hasFile">\n          <div class="base64-file--file-preview"\n               ng-style="{\'background-image\': isImage(file) ? \'url(\' + file.src + \')\': \'\'}">\n            <span ng-show="!isImage(file)">{{file.ext}}</span>\n          </div>\n          <div class="base64-file--file-name">{{file.name}}</div>\n          <div class="base64-file--file-size">{{file.humanSize}}</div>\n          <div class="base64-file--file-remove" ng-click="removeFile($event)">&#10005</div>\n        </div>\n        <span ng-hide="hasFile" class="base64-file--drop-area-description">{{form.placeholder || dropText}}</span>\n      </div>\n    </label>\n  </div>\n\n  <span class="help-block" sf-message="form.description"></span>\n</div>\n')}]),angular.module("angularSchemaFormBase64FileUpload",["schemaForm","templates"]).provider("base64FileUploadConfig",function(){this.setDropText=function(e){this.dropText=e},this.$get=function(){return this}}).config(["schemaFormProvider","schemaFormDecoratorsProvider","sfBuilderProvider","sfPathProvider",function(e,a,i,r){var n=function(a,i,n){if("string"===i.type&&"base64"===i.format){var l=e.stdFormObj(a,i,n);return l.key=n.path,l.type="base64file",n.lookup[r.stringify(n.path)]=l,l}};e.defaults.string.unshift(n),a.defineAddOn("bootstrapDecorator","base64file","src/templates/angular-schema-form-base64-file-upload.html",i.stdBuilders)}]),angular.module("angularSchemaFormBase64FileUpload").directive("base64FileUpload",["base64FileUploadConfig","$timeout",function(e,a){return{restrict:"A",require:"ngModel",scope:!0,link:function(i,r,n,l){i.ngModel=l,i.dropAreaHover=!1,i.file=void 0,i.fileImagePreview="",i.fileError=!1,i.dropText=e.dropText||"Click here or drop files to upload";var s=function(e){var a=!0,r=i.$eval(n.base64FileUpload).schema;return e.size>parseInt(r.maxSize,10)?(a=!1,l.$setValidity("base64FileUploadSize",!1)):l.$setValidity("base64FileUploadSize",!0),i.$apply(),a},t=function(e){if(e&&s(e)){var r=new FileReader;i.file=e,i.file.ext=e.name.split(".").slice(-1)[0],i.file.src=URL.createObjectURL(e),i.hasFile=!0;var n=e.size/1024,t="kB";n>1024&&(n/=1024,t="MB"),i.file.humanSize=n.toFixed(1)+" "+t,r.onloadstart=function(e){a(function(){i.loadingFile=!0},0)},r.onload=function(e){a(function(){i.loadingFile=!1},0),l.$setViewValue(e.target.result)},r.readAsDataURL(e),i.$apply()}};i.isImage=function(e){return e?e.type.indexOf("image")>-1:!1},i.removeFile=function(e){e.preventDefault(),e.stopPropagation(),i.file=void 0,i.hasFile=!1,l.$setViewValue(void 0)},r.find("input").bind("change",function(e){t(e.target.files[0])});var o=document.getElementsByClassName("base64-file--drop-area")[0],d=function(e){e.preventDefault(),e.stopPropagation(),a(function(){i.dropAreaHover=!0},0)},f=function(e){e.preventDefault(),e.stopPropagation(),a(function(){i.dropAreaHover=!1},0)},c=function(e){f(e),t(e.dataTransfer.files[0])};o.addEventListener("dragenter",d,!1),o.addEventListener("dragleave",f,!1),o.addEventListener("dragover",d,!1),o.addEventListener("drop",c,!1),i.$on("$destroy",function(){o.removeEventListener("dragenter",d,!1),o.removeEventListener("dragleave",f,!1),o.removeEventListener("dragover",d,!1),o.removeEventListener("drop",c,!1)})}}}]);